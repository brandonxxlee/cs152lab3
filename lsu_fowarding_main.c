// See LICENSE for license details.

//**************************************************************************
// Vector-vector add benchmark
//--------------------------------------------------------------------------
//
// This benchmark uses adds to vectors and writes the results to a
// third vector. The input data (and reference data) should be
// generated using the vvadd_gendata.pl perl script and dumped
// to a file named dataset1.h.
 
#include "util.h"

//--------------------------------------------------------------------------
// lsu_forwarding function

void lsu_forwarding(int n, int arr[])
{
  // code
  for (int i = 16; i < n; i++) {
    arr[i-15] += arr[i-16];
    arr[i-14] += arr[i-15];
    arr[i-13] += arr[i-14];
    arr[i-12] += arr[i-13];
    arr[i-11] += arr[i-12];
    arr[i-10] += arr[i-11];
    arr[i-9] += arr[i-10];
    arr[i-8] += arr[i-9];
    arr[i-7] += arr[i-8];
    arr[i-6] += arr[i-7];
    arr[i-5] += arr[i-6];
    arr[i-4] += arr[i-5];
    arr[i-3] += arr[i-4];
    arr[i-2] += arr[i-3];
    arr[i-1] += arr[i-2];
    arr[i] += arr[i-1];
  }
}

//--------------------------------------------------------------------------
// Main

int main(int argc, char* argv[])
{

  int input1_data[300] = 
  {
     41, 833, 564, 187, 749, 350, 132, 949, 584, 805, 621,   6, 931, 890, 392, 694, 961, 110, 116, 296,
    426, 314, 659, 774, 319, 678, 875, 376, 474, 938, 539, 569, 203, 280, 759, 606, 511, 657, 195,  81,
    267, 229, 337, 944, 902, 241, 913, 826, 933, 985, 195, 960, 566, 350, 649, 657, 181, 111, 859,  65,
    288, 349, 141, 905, 886, 264, 576, 979, 761, 241, 478, 499, 403, 222, 444, 721, 676, 317, 224, 937,
    288, 119, 615, 606, 389, 351, 455, 278, 367, 358, 584,  62, 985, 403, 346, 517, 559, 908, 775, 255,
    778, 598, 143,  33, 125, 941, 933, 799, 553, 431, 648, 952, 287,  19,  49,  86,  95, 441, 587, 614,
    382, 280, 808, 971, 819, 344, 450, 512, 965, 347, 808, 882, 537, 946, 701, 356, 567, 891,  22, 568,
    665, 423, 434, 158,   2,  84, 247,  49, 435, 792, 869, 486, 414, 369, 548, 518, 888, 682, 284, 264,
    499, 290, 897, 215, 731, 688, 251, 786, 555, 302, 528, 544, 322, 947, 287, 824, 304, 788, 733, 959,
    366, 722, 294, 975, 653, 748,  91, 378, 105, 102, 381, 651, 825, 840, 356, 148,  54, 140, 955, 343,
    533, 757, 521, 837, 592,  13, 173,  63, 121, 133, 758, 372, 951,  39, 129, 110, 847, 437, 255, 269,
    409, 628, 399, 549, 753, 564, 171,  19, 727, 501, 777,  43, 753,  81, 202, 853, 153, 760, 357, 943,
    922, 328, 496, 442, 516, 641, 276, 786, 113, 842, 907, 275, 237,  32, 784, 565, 357, 803, 819, 751,
    280,  85, 458, 454, 710, 459,  41, 253, 377, 508, 700, 860, 480, 741, 499, 709,  49, 371, 873, 945,
    992, 526, 721, 435, 232, 497, 697,  30, 348, 250, 350, 250, 573, 784, 749, 502, 823, 826, 170, 160
  };

  int verify_data[300] = 
  {
  41, 874, 1438, 1625, 2374, 2724, 2856, 3805, 4389, 5194, 5815, 5821, 6752, 7642, 8034, 8728, 9689, 9799, 9915, 10211, 10637, 10951, 11610, 12384, 12703, 13381, 14256, 14632, 15106, 16044, 16583, 17152, 17355, 17635, 18394, 19000, 19511, 20168, 20363, 20444, 20711, 20940, 21277, 22221, 23123, 23364, 24277, 25103, 26036, 27021, 27216, 28176, 28742, 29092, 29741, 30398, 30579, 30690, 31549, 31614, 31902, 32251, 32392, 33297, 34183, 34447, 35023, 36002, 36763, 37004, 37482, 37981, 38384, 38606, 39050, 39771, 40447, 40764, 40988, 41925, 42213, 42332, 42947, 43553, 43942, 44293, 44748, 45026, 45393, 45751, 46335, 46397, 47382, 47785, 48131, 48648, 49207, 50115, 50890, 51145, 51923, 52521, 52664, 52697, 52822, 53763, 54696, 55495, 56048, 56479, 57127, 58079, 58366, 58385, 58434, 58520, 58615, 59056, 59643, 60257, 60639, 60919, 61727, 62698, 63517, 63861, 64311, 64823, 65788, 66135, 66943, 67825, 68362, 69308, 70009, 70365, 70932, 71823, 71845, 72413, 73078, 73501, 73935, 74093, 74095, 74179, 74426, 74475, 74910, 75702, 76571, 77057, 77471, 77840, 78388, 78906, 79794, 80476, 80760, 81024, 81523, 81813, 82710, 82925, 83656, 84344, 84595, 85381, 85936, 86238, 86766, 87310, 87632, 88579, 88866, 89690, 89994, 90782, 91515, 92474, 92840, 93562, 93856, 94831, 95484, 96232, 96323, 96701, 96806, 96908, 97289, 97940, 98765, 99605, 99961, 100109, 100163, 100303, 101258, 101601, 102134, 102891, 103412, 104249, 104841, 104854, 105027, 105090, 105211, 105344, 106102, 106474, 107425, 107464, 107593, 107703, 108550, 108987, 109242, 109511, 109920, 110548, 110947, 111496, 112249, 112813, 112984, 113003, 113730, 114231, 115008, 115051, 115804, 115885, 116087, 116940, 117093, 117853, 118210, 119153, 120075, 120403, 120899, 121341, 121857, 122498, 122774, 123560, 123673, 124515, 125422, 125697, 125934, 125966, 126750, 127315, 127672, 128475, 129294, 130045, 130325, 130410, 130868, 131322, 132032, 132491, 132532, 132785, 133162, 133670, 134370, 135230, 135710, 136451, 136950, 137659, 137708, 138079, 138952, 139897, 140889, 141415, 142136, 142571, 142803, 143300, 143997, 144027, 144375, 144625, 144975, 145225, 145798, 146582, 147331, 147833, 148656, 149482, 149652, 149812
  };

  setStats(1);
  lsu_forwarding(300, input1_data);
  setStats(0);

  return verify(300, verify_data, verify_data);
}
